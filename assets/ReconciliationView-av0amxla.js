import{_ as M,E as T,c as b,a as o,b as e,w as n,d as S,e as r,t as p,f as V,r as m,o as g,F as C,g as v,h as A}from"./index-nU4IdXbg.js";const B={data(){return{disabledDate(a){return a.getTime()>Date.now()},searchData:{date:"",cashFlowSource:"",bankAccount:""},searchOrigin:[],cashFlowSources:[],bankAccounts:[],isComparing:!1,bankFlow:[],countBankFlow:null,totalBankFlow:null,systemFlow:[],countSystemFlow:null,totalSystemFlow:null,dialogSystemVisible:!1,addSystemData:{postingDate:"",depositAmount:null,station:"",department:""},systemFormRules:{postingDate:[{required:!0,message:"請選擇入帳日",trigger:"change"}],station:[{required:!0,message:"請輸入場站名稱",trigger:"blur"}],depositAmount:[{required:!0,message:"請輸入入帳金額",trigger:"blur"}],department:[{required:!0,message:"請輸入部門名稱",trigger:"blur"}]},dialogTableVisible:!1,systemFlowDetails:[],dialogVisible:!1,addDetailDialogVisible:!1,deleteDetailDialogVisible:!1,deleteDetailData:null,transferData:[]}},methods:{getSearchOrigin(){this.searchOrigin=[{id:1,companyId:1,bankMemo:"iPASS MONEY",voucherDesc:"一卡通",message:null,bankId:1,name:"力揚彰銀臨停",bankCode:"009",account:"41150119912400"},{id:2,companyId:1,bankMemo:"國泰世華商連加",voucherDesc:"連加",message:null,bankId:1,name:"力揚彰銀臨停一",bankCode:"009",account:"41150119912401"},{id:3,companyId:1,bankMemo:"悠遊卡公司",voucherDesc:"悠遊卡",message:"悠遊卡舊系統",bankId:1,name:"力揚彰銀臨停",bankCode:"009",account:"41150119912406"}],this.getCashFlowSources(),this.getBankAccountSources()},getCashFlowSources(){this.cashFlowSources=this.searchOrigin.map(a=>a.bankMemo.trim())},getBankAccountSources(){this.bankAccounts=this.searchOrigin.map(a=>({name:a.name.trim(),account:`${a.bankCode}${a.account}`}))},show(){if(this.searchData.date!==""&&this.searchData.cashFlowSource!==""&&this.searchData.bankAccount!==""){const a=T.service({lock:!0,text:"比對中...",background:"rgba(0, 0, 0, 0.7)"});setTimeout(()=>{a.close(),this.countBankFlow=null,this.totalBankFlow=null,this.countSystemFlow=null,this.totalSystemFlow=null,this.compare()},2e3)}else alert("搜尋欄位不得為空！")},getBankFlow(){this.bankFlow=[{id:1,station:"",postingDate:"2024-01-01",depositAmount:1e3,note:"這是備註訊息"},{id:2,station:"",postingDate:"2024-01-01",depositAmount:1300,note:""},{id:3,station:"",postingDate:"2024-01-01",depositAmount:1200,note:"這是備註訊息"},{id:4,station:"",postingDate:"2024-01-01",depositAmount:900,note:""},{id:5,station:"",postingDate:"2024-01-01",depositAmount:500,note:""}],this.countBankFlow=this.bankFlow.length,this.bankFlow.forEach(a=>{this.totalBankFlow+=a.depositAmount})},getSystemFlow(){this.systemFlow=[{id:64,postingDate:"2024-01-01",transactionAmount:515,fee:15,depositAmount:500,transactionCode:"y11111111",station:"富岡停一停車場",department:"部門一"},{id:98,postingDate:"2024-01-01",transactionAmount:915,fee:15,depositAmount:900,transactionCode:"y22222222",station:"南崁廣停一",department:"部門二"},{id:119,postingDate:"2024-01-01",transactionAmount:1315,fee:15,depositAmount:1300,transactionCode:"y33333333",station:"瑞芳消防分隊營業所",department:"部門一"},{id:191,postingDate:"2024-01-01",transactionAmount:515,fee:15,depositAmount:500,transactionCode:"y44444444",station:"桃園停三",department:"部門一"},{id:199,postingDate:"2024-01-01",transactionAmount:515,fee:15,depositAmount:500,transactionCode:"y55555555",station:"桃園停一",department:"部門二"}],this.countSystemFlow=this.systemFlow.length,this.systemFlow.forEach(a=>{this.totalSystemFlow+=a.depositAmount})},handleSystemFlowChange(a){alert("修改成功"),console.log(a)},openSystemDiolog(){this.dialogSystemVisible=!0,this.searchData.postingDate!==""&&(this.addSystemData.postingDate=this.searchData.date)},addSystem(){this.$refs.addSystemForm.validate(a=>{a&&(alert("新增成功"),console.log("新增系統帳資料",this.addSystemData),this.addSystemData={},this.dialogSystemVisible=!1)})},cancelAddSystem(){this.addSystemData={},this.dialogSystemVisible=!1},amountFormatter(a,s,c){return c+="",c.includes(".")||(c+="."),c.replace(/(\d)(?=(\d{3})+\.)/g,function(x,l){return l+","}).replace(/\.$/,"")},compare(){this.getBankFlow(),this.getSystemFlow(),this.bankFlow.forEach(a=>{const s=this.systemFlow.find(c=>c.depositAmount===a.depositAmount);s&&(a.station=s.station)}),console.log("比對完啦",this.bankFlow)},customRowClassName({row:a}){return a.station!==""?"bg-success text-white":""},customSystemRowClassName({row:a}){return this.bankFlow.some(c=>c.station===a.station&&c.postingDate===a.postingDate)?"bg-success text-white":""},openDetailDialog(a){console.log(a.row),this.dialogTableVisible=!0,this.getDetail(a)},getDetail(a){console.log("查看",a.row),this.systemFlowDetails=[{outDate:"2024-01-01",transactionTime:"12:30:43",amount:80},{outDate:"2024-01-01",transactionTime:"14:11:34",amount:120},{outDate:"2024-01-01",transactionTime:"16:51:11",amount:160},{outDate:"2024-01-01",transactionTime:"18:40:51",amount:160},{outDate:"2024-01-01",transactionTime:"18:53:20",amount:80},{outDate:"2024-01-01",transactionTime:"19:11:45",amount:200},{outDate:"2024-01-01",transactionTime:"19:41:38",amount:160},{outDate:"2024-01-01",transactionTime:"20:28:54",amount:40},{outDate:"2024-01-01",transactionTime:"21:53:28",amount:200}]},handleDetailAmountChange(a){a.outDate!==null&a.amount!==""?(console.log("交易明細變更",a),alert("修改成功")):alert("修改欄位不得為空！")},openAddDetailDialog(){this.addDetailDialogVisible=!0},openDeleteDetailDialog(a){this.deleteDetailDialogVisible=!0,this.deleteDetailData=a},deleteDetail(a){alert("刪除明細成功～"),this.getDetail(a),console.log(this.deleteDetailData),this.deleteDetailDialogVisible=!1},cencelDeleteDetail(){this.deleteDetailDialogVisible=!1},transfer(){this.transferData=this.bankFlow.filter(a=>a.station!=""),this.transferData.length>0?(this.bankFlow=this.bankFlow.filter(a=>a.station==""),alert("完成轉傳票"),console.log("轉傳票",this.transferData)):alert("無可以轉傳票的資料！")}},mounted(){this.getSearchOrigin()}},U={class:"container"},N=o("h1",{class:"my-3 text-center"},"對帳系統",-1),E={class:"row align-items-center"},O={class:"col-md-3"},R={class:"col-md-3"},I={class:"col-md-3"},j={class:"col-md-2 mobile-btns"},q=o("p",{class:"text-end"},[o("br"),o("span",{class:"bg-success text-white p-1"},"綠底標註"),r("為符合的比對結果 ")],-1),L={class:"row"},P={class:"col-md-6"},z=o("h2",{class:"text-center my-2"},"銀行帳",-1),G={key:0,class:"text-end"},H={class:"col-md-6"},J=o("h2",{class:"text-center my-2"},"系統帳",-1),K={key:0,class:"text-end"},Q={class:"d-flex justify-content-between"},W={class:"d-flex flex-column"},X={class:"row mb-2 justify-content-center"},Z=o("div",{class:"col-3 text-end"},"入帳日期：",-1),$={class:"col-4 text-start fw-bold"},ee={class:"row mb-2 justify-content-center"},te=o("div",{class:"col-3 text-end"},"交易時間：",-1),ae={class:"col-4 text-start fw-bold"},le={class:"row mb-2 justify-content-center"},oe=o("div",{class:"col-3 text-end"},"交易金額：",-1),se={class:"col-4 text-start fw-bold"},ne={class:"dialog-footer"};function ie(a,s,c,x,l,i){const f=m("el-date-picker"),k=m("el-option"),F=m("el-select"),d=m("el-table-column"),w=m("el-table"),u=m("el-button"),D=m("el-form-item"),_=m("el-input"),Y=m("el-form"),y=m("el-dialog");return g(),b("div",U,[N,o("form",E,[o("div",O,[e(f,{class:"align-self-stretch",style:{width:"100%"},modelValue:l.searchData.date,"onUpdate:modelValue":s[0]||(s[0]=t=>l.searchData.date=t),type:"date",placeholder:"請選擇入帳日期",format:"YYYY/MM/DD","value-format":"YYYY-MM-DD","disabled-date":l.disabledDate,clearable:!1},null,8,["modelValue","disabled-date"])]),o("div",R,[e(F,{modelValue:l.searchData.cashFlowSource,"onUpdate:modelValue":s[1]||(s[1]=t=>l.searchData.cashFlowSource=t),placeholder:"請選擇金流來源"},{default:n(()=>[(g(!0),b(C,null,v(l.cashFlowSources,t=>(g(),A(k,{key:t,label:t,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),o("div",I,[e(F,{modelValue:l.searchData.bankAccount,"onUpdate:modelValue":s[2]||(s[2]=t=>l.searchData.bankAccount=t),placeholder:"請選擇銀行來源"},{default:n(()=>[(g(!0),b(C,null,v(l.bankAccounts,t=>(g(),A(k,{key:t.account,label:t.account,value:t.account},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),o("div",j,[o("button",{class:"btn btn-success",onClick:s[3]||(s[3]=S((...t)=>i.show&&i.show(...t),["prevent"]))},"顯示"),o("button",{class:"btn btn-outline-success",onClick:s[4]||(s[4]=S((...t)=>i.transfer&&i.transfer(...t),["prevent"]))},"轉傳票")])]),q,o("div",L,[o("div",P,[z,l.countBankFlow>0?(g(),b("p",G,[r(" 共  "),o("strong",null,p(l.countBankFlow),1),r("  筆 "),o("span",null,[r("  / 總金額 $ "),o("strong",null,p(l.totalBankFlow.toLocaleString("en",{minimumFractionDigits:0})),1)])])):V("",!0),e(w,{data:l.bankFlow,"row-style":{height:"50px"},"row-class-name":i.customRowClassName,height:"450"},{default:n(()=>[e(d,{align:"center",prop:"station",label:"場站名稱",width:"180"}),e(d,{align:"center",prop:"postingDate",label:"入帳日",width:"180"}),e(d,{align:"center",prop:"depositAmount",sortable:"",formatter:i.amountFormatter,label:"入帳金額",width:"110"},null,8,["formatter"]),e(d,{align:"center",prop:"note",label:"註記",width:"180"})]),_:1},8,["data","row-class-name"])]),o("div",H,[J,l.countSystemFlow>0?(g(),b("p",K,[r(" 共  "),o("strong",null,p(l.countSystemFlow),1),r("  筆 "),o("span",null,[r("  / 總金額 $ "),o("strong",null,p(l.totalSystemFlow.toLocaleString("en",{minimumFractionDigits:0})),1)])])):V("",!0),e(w,{data:l.systemFlow,"row-style":{height:"50px"},"row-class-name":i.customSystemRowClassName,height:"450"},{default:n(()=>[e(d,{align:"center",prop:"station",label:"場站名稱",width:"180"}),e(d,{align:"center",prop:"postingDate",label:"入帳日",width:"210"},{default:n(t=>[o("div",Q,[e(f,{class:"align-self-stretch",style:{width:"100%"},modelValue:t.row.postingDate,"onUpdate:modelValue":h=>t.row.postingDate=h,type:"date",placeholder:"請選擇入帳日期",format:"YYYY/MM/DD","value-format":"YYYY-MM-DD","disabled-date":l.disabledDate,clearable:!1},null,8,["modelValue","onUpdate:modelValue","disabled-date"]),e(u,{onClick:h=>i.handleSystemFlowChange(t.row)},{default:n(()=>[r("確認")]),_:2},1032,["onClick"])])]),_:1}),e(d,{align:"center",prop:"depositAmount",sortable:"",formatter:i.amountFormatter,label:"入帳金額",width:"110"},null,8,["formatter"]),e(d,{align:"center",prop:"transactionAmount",sortable:"",formatter:i.amountFormatter,label:"交易金額",width:"110"},null,8,["formatter"]),e(d,{align:"center",prop:"fee",sortable:"",formatter:i.amountFormatter,label:"手續費",width:"110"},null,8,["formatter"]),e(d,{align:"center",prop:"transactionCode",label:"交易代號",width:"100"}),e(d,{align:"center",prop:"department",label:"部門",width:"100"}),e(d,{align:"center",label:"明細",width:"120",fixed:"right"},{default:n(t=>[e(u,{onClick:h=>i.openDetailDialog(t)},{default:n(()=>[r("查看明細")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","row-class-name"]),e(u,{type:"success",class:"mt-4",style:{width:"100%"},onClick:s[5]||(s[5]=t=>i.openSystemDiolog())},{default:n(()=>[r(" 新增系統帳資料 ")]),_:1})]),e(y,{modelValue:l.dialogSystemVisible,"onUpdate:modelValue":s[10]||(s[10]=t=>l.dialogSystemVisible=t),title:"新增系統帳資料",center:"",fullscreen:!0,"title-class":"dialog-title"},{default:n(()=>[e(Y,{style:{"max-width":"500px","text-align":"center",margin:"0 auto"},"label-width":"120px","label-position":"right",ref:"addSystemForm",model:l.addSystemData,rules:l.systemFormRules},{default:n(()=>[e(D,{label:"入帳日","label-position":"right",prop:"postingDate"},{default:n(()=>[e(f,{modelValue:l.addSystemData.postingDate,"onUpdate:modelValue":s[6]||(s[6]=t=>l.addSystemData.postingDate=t),type:"date",placeholder:"請選擇入帳日",format:"YYYY/MM/DD","value-format":"YYYY-MM-DD","disabled-date":l.disabledDate,clearable:!1},null,8,["modelValue","disabled-date"])]),_:1}),e(D,{label:"場站名稱","label-position":"right",prop:"station"},{default:n(()=>[e(_,{modelValue:l.addSystemData.station,"onUpdate:modelValue":s[7]||(s[7]=t=>l.addSystemData.station=t),placeholder:"請輸入場站名稱",type:"text",autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(D,{label:"入帳金額","label-position":"right",prop:"depositAmount"},{default:n(()=>[e(_,{modelValue:l.addSystemData.depositAmount,"onUpdate:modelValue":s[8]||(s[8]=t=>l.addSystemData.depositAmount=t),placeholder:"請輸入入帳金額",type:"number",min:"1",autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(D,{label:"部門","label-position":"right",prop:"department"},{default:n(()=>[e(_,{modelValue:l.addSystemData.department,"onUpdate:modelValue":s[9]||(s[9]=t=>l.addSystemData.department=t),placeholder:"請輸入部門",type:"text",autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(D,null,{default:n(()=>[e(u,{type:"success",onClick:i.addSystem},{default:n(()=>[r("確認")]),_:1},8,["onClick"]),e(u,{onClick:i.cancelAddSystem},{default:n(()=>[r("取消")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),e(y,{modelValue:l.dialogTableVisible,"onUpdate:modelValue":s[12]||(s[12]=t=>l.dialogTableVisible=t),"close-on-click-modal":!1,align:"center",title:"交易明細",width:"70vw"},{default:n(()=>[e(w,{data:l.systemFlowDetails,height:"500"},{default:n(()=>[e(d,{align:"center",property:"outDate",label:"入帳日期"},{default:n(t=>[e(f,{class:"align-self-stretch",modelValue:t.row.outDate,"onUpdate:modelValue":h=>t.row.outDate=h,type:"date",placeholder:"請選擇入帳日期",format:"YYYY/MM/DD","value-format":"YYYY-MM-DD","disabled-date":l.disabledDate,clearable:!1},null,8,["modelValue","onUpdate:modelValue","disabled-date"])]),_:1}),e(d,{align:"center",property:"transactionTime",label:"交易時間",sortable:""}),e(d,{align:"center",property:"amount",label:"金額",sortable:"",formatter:i.amountFormatter},null,8,["formatter"]),e(d,{align:"center",label:"調整"},{default:n(t=>[e(u,{onClick:h=>i.handleDetailAmountChange(t.row)},{default:n(()=>[r("確認調整")]),_:2},1032,["onClick"])]),_:1}),e(d,{align:"center",label:"刪除"},{default:n(t=>[e(u,{type:"danger",onClick:h=>i.openDeleteDetailDialog(t.row)},{default:n(()=>[r("刪除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(u,{type:"success",class:"mt-2"},{default:n(()=>[r("新增交易明細")]),_:1}),e(y,{modelValue:l.deleteDetailDialogVisible,"onUpdate:modelValue":s[11]||(s[11]=t=>l.deleteDetailDialogVisible=t),"close-on-click-modal":!1,title:"刪除交易明細",width:"500",center:"","align-center":""},{footer:n(()=>[o("div",ne,[e(u,{onClick:i.cencelDeleteDetail},{default:n(()=>[r("取消")]),_:1},8,["onClick"]),e(u,{type:"danger",onClick:i.deleteDetail},{default:n(()=>[r("確認刪除")]),_:1},8,["onClick"])])]),default:n(()=>[o("div",W,[o("div",X,[Z,o("div",$,p(l.deleteDetailData.outDate),1)]),o("div",ee,[te,o("div",ae,p(l.deleteDetailData.transactionTime),1)]),o("div",le,[oe,o("div",se,p(l.deleteDetailData.amount),1)])])]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])])])}const re=M(B,[["render",ie]]);export{re as default};
