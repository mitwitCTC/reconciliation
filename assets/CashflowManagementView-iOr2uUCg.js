import{_ as y,c as g,a as i,t as m,b as t,w as s,A as w,r,o as h,d as u,F as b,e as I,f as F}from"./index-uJ9wh_J2.js";const S={data(){return{pageTitle:"",cashFlow:[],dialogVisible:!1,isEditing:!1,currentCashFlow:{merchnatId:"",bankId:"",parkId:"",cashflowClassId:""},deleteDialogVisible:!1,deleteCashflowData:{},searchInfo:{},carParkOptions:[],cashflowClassOptions:[],cashFlowFormRules:{merchnatId:[{required:!0,message:"請輸入特店代號",trigger:"blur"}],bankId:[{required:!0,message:"請選擇銀行",trigger:"change"}],parkId:[{required:!0,message:"請選擇場站",trigger:"change"}],cashflowClassId:[{required:!0,message:"請選擇金流來源",trigger:"change"}]}}},methods:{getPageTitle(){this.pageTitle=this.$route.name},searchCashFlow(){const o=`${w}/main/searchCashFlow`;this.axios.get(o).then(e=>{this.cashFlow=e.data.data})},openCashflowDialog(o){o?(this.currentCashFlow={...o},this.isEditing=!0):(this.currentCashFlow={merchnatId:"",bankId:"",parkId:"",cashflowClassId:""},this.isEditing=!1),this.dialogVisible=!0},getSearchInfo(){const o=`${w}/main/searchInfo`;this.axios.get(o).then(e=>{e.data.returnCode==0&&(this.searchInfo=e.data.data)})},getSearchCashFlowData(){const o=this.searchInfo.bank.find(n=>n.id===this.currentCashFlow.bankId);if(!o)return;const e=o.companyId;this.carParkOptions=this.searchInfo.carPark.filter(n=>n.companyId===e),this.cashflowClassOptions=this.searchInfo.cashflowClass.filter(n=>n.companyId===e),this.currentCashFlow.parkId=null,this.currentCashFlow.cashflowClassId=null},saveCashflow(){this.$refs.eidtCashflowForm.validate(o=>{if(o){if(this.isEditing){const e=`${w}/main/updateCashFlow`;this.axios.post(e,this.currentCashFlow).then(n=>{n.data.returnCode==0&&(alert("修改成功"),this.searchCashFlow())})}else{const e=`${w}/main/insertCashFlow`;this.axios.post(e,this.currentCashFlow).then(n=>{n.data.returnCode==0&&(alert(n.data.message),this.searchCashFlow())})}this.dialogVisible=!1}})},cancelSaveCashflow(){this.dialogVisible=!1,this.$refs.eidtCashflowForm.clearValidate()},openDeleteCashFlowDialog(o){this.deleteDialogVisible=!0,this.deleteCashflowData={...o}},deleteCahsflow(){const o=`${w}/main/deleteCashFlow`;this.axios.post(o,{id:this.deleteCashflowData.id}).then(e=>{e.data.returnCode==0&&(alert(e.data.message),this.searchCashFlow(),this.deleteDialogVisible=!1)})}},mounted(){this.getPageTitle(),this.searchCashFlow(),this.getSearchInfo()},computed:{dialogTitle(){return this.isEditing?"修改金流":"新增金流"}},watch:{"currentCashflow.bankId"(o,e){o!==null&&o!==e&&this.getSearchCashFlowData()}}},T={class:"container"},A={class:"d-flex justify-content-center align-items-center"},N={class:"flex-grow-1 text-center"},P={class:"dialog-footer d-flex justify-content-end"},j={class:"d-flex flex-column"},E={class:"row mb-2 justify-content-center"},O=i("div",{class:"col-3 text-end"},"特店代號",-1),U={class:"col-4 text-start fw-bold"},B={class:"row mb-2 justify-content-center"},q=i("div",{class:"col-3 text-end"},"銀行",-1),R={class:"col-4 text-start fw-bold"},L={class:"row mb-2 justify-content-center"},M=i("div",{class:"col-3 text-end"},"場站名稱",-1),z={class:"col-4 text-start fw-bold"},G={class:"row mb-2 justify-content-center"},H=i("div",{class:"col-3 text-end"},"金流來源",-1),J={class:"col-4 text-start fw-bold"},K={class:"dialog-footer"};function Q(o,e,n,W,a,d){const c=r("el-button"),f=r("el-table-column"),V=r("el-table"),v=r("el-input"),C=r("el-form-item"),_=r("el-option"),p=r("el-select"),x=r("el-form"),k=r("el-dialog");return h(),g("div",T,[i("div",A,[i("h2",N,m(a.pageTitle),1),t(c,{class:"ms-auto",onClick:e[0]||(e[0]=l=>d.openCashflowDialog())},{default:s(()=>[u("新增")]),_:1})]),t(V,{data:a.cashFlow,height:"600"},{default:s(()=>[t(f,{align:"center",prop:"merchnatId",label:"特店代號"}),t(f,{align:"center",prop:"bankName",label:"銀行"}),t(f,{align:"center",prop:"parkName",label:"場站名稱"}),t(f,{align:"center",prop:"casedescribe",label:"金流來源"}),t(f,{align:"center",label:"修改",fixed:"right"},{default:s(l=>[t(c,{onClick:D=>d.openCashflowDialog(l.row)},{default:s(()=>[u("修改")]),_:2},1032,["onClick"])]),_:1}),t(f,{align:"center",label:"刪除",fixed:"right"},{default:s(l=>[t(c,{type:"danger",onClick:D=>d.openDeleteCashFlowDialog(l.row)},{default:s(()=>[u("刪除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),t(k,{modelValue:a.dialogVisible,"onUpdate:modelValue":e[5]||(e[5]=l=>a.dialogVisible=l),title:d.dialogTitle,width:"500",center:""},{default:s(()=>[t(x,{model:a.currentCashFlow,"label-width":"auto",rules:a.cashFlowFormRules,ref:"eidtCashflowForm"},{default:s(()=>[t(C,{label:"特店代號",prop:"merchnatId"},{default:s(()=>[t(v,{modelValue:a.currentCashFlow.merchnatId,"onUpdate:modelValue":e[1]||(e[1]=l=>a.currentCashFlow.merchnatId=l)},null,8,["modelValue"])]),_:1}),t(C,{label:"銀行",prop:"bankId"},{default:s(()=>[t(p,{modelValue:a.currentCashFlow.bankId,"onUpdate:modelValue":e[2]||(e[2]=l=>a.currentCashFlow.bankId=l),placeholder:"請選擇銀行",onChange:d.getSearchCashFlowData},{default:s(()=>[(h(!0),g(b,null,I(a.searchInfo.bank,l=>(h(),F(_,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),_:1}),t(C,{label:"場站",prop:"parkId"},{default:s(()=>[t(p,{modelValue:a.currentCashFlow.parkId,"onUpdate:modelValue":e[3]||(e[3]=l=>a.currentCashFlow.parkId=l),placeholder:"請先選擇銀行"},{default:s(()=>[(h(!0),g(b,null,I(a.carParkOptions,l=>(h(),F(_,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(C,{label:"金流",prop:"cashflowClassId"},{default:s(()=>[t(p,{modelValue:a.currentCashFlow.cashflowClassId,"onUpdate:modelValue":e[4]||(e[4]=l=>a.currentCashFlow.cashflowClassId=l),placeholder:"請先選擇銀行"},{default:s(()=>[(h(!0),g(b,null,I(a.cashflowClassOptions,l=>(h(),F(_,{key:l.id,label:l.casedescribe,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),i("div",P,[t(c,{onClick:d.cancelSaveCashflow},{default:s(()=>[u("取消")]),_:1},8,["onClick"]),t(c,{type:"primary",onClick:d.saveCashflow},{default:s(()=>[u("確定")]),_:1},8,["onClick"])])]),_:1},8,["modelValue","title"]),t(k,{modelValue:a.deleteDialogVisible,"onUpdate:modelValue":e[7]||(e[7]=l=>a.deleteDialogVisible=l),"close-on-click-modal":!1,title:"刪除金流",width:"500",center:""},{footer:s(()=>[i("div",K,[t(c,{onClick:e[6]||(e[6]=l=>a.deleteDialogVisible=!1)},{default:s(()=>[u("取消")]),_:1}),t(c,{type:"danger",onClick:d.deleteCahsflow},{default:s(()=>[u("確認刪除")]),_:1},8,["onClick"])])]),default:s(()=>[i("div",j,[i("div",E,[O,i("div",U,m(a.deleteCashflowData.merchnatId),1)]),i("div",B,[q,i("div",R,m(a.deleteCashflowData.bankName),1)]),i("div",L,[M,i("div",z,m(a.deleteCashflowData.parkName),1)]),i("div",G,[H,i("div",J,m(a.deleteCashflowData.casedescribe),1)])])]),_:1},8,["modelValue"])])}const Y=y(S,[["render",Q]]);export{Y as default};
