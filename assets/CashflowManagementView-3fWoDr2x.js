import{_ as y,E as S,c as g,a as i,t as w,b as t,w as o,A as C,r,o as h,d as u,F as b,e as I,f as F}from"./index-KQMgRxY9.js";const E={data(){return{pageTitle:"",cashFlow:[],dialogVisible:!1,isEditing:!1,currentCashFlow:{merchnatId:"",bankId:"",parkId:"",cashflowClassId:""},deleteDialogVisible:!1,deleteCashflowData:{},searchInfo:{},carParkOptions:[],cashflowClassOptions:[],cashFlowFormRules:{merchnatId:[{required:!0,message:"請輸入特店代號",trigger:"blur"}],bankId:[{required:!0,message:"請選擇銀行",trigger:"change"}],parkId:[{required:!0,message:"請選擇場站",trigger:"change"}],cashflowClassId:[{required:!0,message:"請選擇金流來源",trigger:"change"}]}}},methods:{showLoading(s="載入中..."){return S.service({lock:!0,text:s,background:"rgba(0, 0, 0, 0.7)"})},getPageTitle(){this.pageTitle=this.$route.name},searchCashFlow(){const s=this.showLoading("載入中..."),e=`${C}/main/searchCashFlow`;this.axios.get(e).then(n=>{this.cashFlow=n.data.data,s.close()})},openCashflowDialog(s){if(s){this.currentCashFlow={...s},this.isEditing=!0;const e=this.currentCashFlow.parkId,n=this.currentCashFlow.cashflowClassId;this.getSearchCashFlowData(),this.currentCashFlow.parkId=e,this.currentCashFlow.cashflowClassId=n}else this.currentCashFlow={merchnatId:"",bankId:"",parkId:"",cashflowClassId:""},this.isEditing=!1;this.dialogVisible=!0},getSearchInfo(){const s=`${C}/main/searchInfo`;this.axios.get(s).then(e=>{e.data.returnCode==0&&(this.searchInfo=e.data.data)})},getSearchCashFlowData(){const s=this.searchInfo.bank.find(n=>n.id===this.currentCashFlow.bankId);if(!s)return;const e=s.companyId;this.carParkOptions=this.searchInfo.carPark.filter(n=>n.companyId===e),this.cashflowClassOptions=this.searchInfo.cashflowClass.filter(n=>n.companyId===e),this.currentCashFlow.parkId=null,this.currentCashFlow.cashflowClassId=null},saveCashflow(){this.$refs.eidtCashflowForm.validate(s=>{if(s){if(this.isEditing){const e=`${C}/main/updateCashFlow`;this.axios.post(e,this.currentCashFlow).then(n=>{n.data.returnCode==0&&(alert("修改成功"),this.searchCashFlow())})}else{const e=`${C}/main/insertCashFlow`;this.axios.post(e,this.currentCashFlow).then(n=>{n.data.returnCode==0&&(alert(n.data.message),this.searchCashFlow())})}this.dialogVisible=!1}})},cancelSaveCashflow(){this.dialogVisible=!1,this.$refs.eidtCashflowForm.clearValidate()},openDeleteCashFlowDialog(s){this.deleteDialogVisible=!0,this.deleteCashflowData={...s}},deleteCahsflow(){const s=`${C}/main/deleteCashFlow`;this.axios.post(s,{id:this.deleteCashflowData.id}).then(e=>{e.data.returnCode==0&&(alert(e.data.message),this.searchCashFlow(),this.deleteDialogVisible=!1)})}},mounted(){this.getPageTitle(),this.searchCashFlow(),this.getSearchInfo()},computed:{dialogTitle(){return this.isEditing?"修改金流":"新增金流"}},watch:{"currentCashflow.bankId"(s,e){s!==null&&s!==e&&this.getSearchCashFlowData()}}},P={class:"container"},T={class:"d-flex justify-content-center align-items-center"},A={class:"flex-grow-1 text-center"},N={class:"dialog-footer d-flex justify-content-end"},j={class:"d-flex flex-column"},O={class:"row mb-2 justify-content-center"},U=i("div",{class:"col-3 text-end"},"特店代號",-1),B={class:"col-4 text-start fw-bold"},q={class:"row mb-2 justify-content-center"},L=i("div",{class:"col-3 text-end"},"銀行",-1),R={class:"col-4 text-start fw-bold"},M={class:"row mb-2 justify-content-center"},z=i("div",{class:"col-3 text-end"},"場站名稱",-1),G={class:"col-4 text-start fw-bold"},H={class:"row mb-2 justify-content-center"},J=i("div",{class:"col-3 text-end"},"金流來源",-1),K={class:"col-4 text-start fw-bold"},Q={class:"dialog-footer"};function W(s,e,n,X,a,d){const c=r("el-button"),f=r("el-table-column"),v=r("el-table"),V=r("el-input"),m=r("el-form-item"),p=r("el-option"),_=r("el-select"),x=r("el-form"),k=r("el-dialog");return h(),g("div",P,[i("div",T,[i("h2",A,w(a.pageTitle),1),t(c,{class:"ms-auto",onClick:e[0]||(e[0]=l=>d.openCashflowDialog())},{default:o(()=>[u("新增")]),_:1})]),t(v,{data:a.cashFlow,height:"600"},{default:o(()=>[t(f,{align:"center",prop:"merchnatId",label:"特店代號"}),t(f,{align:"center",prop:"bankName",label:"銀行"}),t(f,{align:"center",prop:"parkName",label:"場站名稱"}),t(f,{align:"center",prop:"casedescribe",label:"金流來源"}),t(f,{align:"center",label:"修改",fixed:"right"},{default:o(l=>[t(c,{onClick:D=>d.openCashflowDialog(l.row)},{default:o(()=>[u("修改")]),_:2},1032,["onClick"])]),_:1}),t(f,{align:"center",label:"刪除",fixed:"right"},{default:o(l=>[t(c,{type:"danger",onClick:D=>d.openDeleteCashFlowDialog(l.row)},{default:o(()=>[u("刪除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),t(k,{modelValue:a.dialogVisible,"onUpdate:modelValue":e[5]||(e[5]=l=>a.dialogVisible=l),title:d.dialogTitle,width:"500",center:""},{default:o(()=>[t(x,{model:a.currentCashFlow,"label-width":"auto",rules:a.cashFlowFormRules,ref:"eidtCashflowForm"},{default:o(()=>[t(m,{label:"特店代號",prop:"merchnatId"},{default:o(()=>[t(V,{modelValue:a.currentCashFlow.merchnatId,"onUpdate:modelValue":e[1]||(e[1]=l=>a.currentCashFlow.merchnatId=l)},null,8,["modelValue"])]),_:1}),t(m,{label:"銀行",prop:"bankId"},{default:o(()=>[t(_,{modelValue:a.currentCashFlow.bankId,"onUpdate:modelValue":e[2]||(e[2]=l=>a.currentCashFlow.bankId=l),placeholder:"請選擇銀行",onChange:d.getSearchCashFlowData},{default:o(()=>[(h(!0),g(b,null,I(a.searchInfo.bank,l=>(h(),F(p,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),_:1}),t(m,{label:"場站",prop:"parkId"},{default:o(()=>[t(_,{modelValue:a.currentCashFlow.parkId,"onUpdate:modelValue":e[3]||(e[3]=l=>a.currentCashFlow.parkId=l),placeholder:"請先選擇銀行"},{default:o(()=>[(h(!0),g(b,null,I(a.carParkOptions,l=>(h(),F(p,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"金流",prop:"cashflowClassId"},{default:o(()=>[t(_,{modelValue:a.currentCashFlow.cashflowClassId,"onUpdate:modelValue":e[4]||(e[4]=l=>a.currentCashFlow.cashflowClassId=l),placeholder:"請先選擇銀行"},{default:o(()=>[(h(!0),g(b,null,I(a.cashflowClassOptions,l=>(h(),F(p,{key:l.id,label:l.casedescribe,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),i("div",N,[t(c,{onClick:d.cancelSaveCashflow},{default:o(()=>[u("取消")]),_:1},8,["onClick"]),t(c,{type:"primary",onClick:d.saveCashflow},{default:o(()=>[u("確定")]),_:1},8,["onClick"])])]),_:1},8,["modelValue","title"]),t(k,{modelValue:a.deleteDialogVisible,"onUpdate:modelValue":e[7]||(e[7]=l=>a.deleteDialogVisible=l),"close-on-click-modal":!1,title:"刪除金流",width:"500",center:""},{footer:o(()=>[i("div",Q,[t(c,{onClick:e[6]||(e[6]=l=>a.deleteDialogVisible=!1)},{default:o(()=>[u("取消")]),_:1}),t(c,{type:"danger",onClick:d.deleteCahsflow},{default:o(()=>[u("確認刪除")]),_:1},8,["onClick"])])]),default:o(()=>[i("div",j,[i("div",O,[U,i("div",B,w(a.deleteCashflowData.merchnatId),1)]),i("div",q,[L,i("div",R,w(a.deleteCashflowData.bankName),1)]),i("div",M,[z,i("div",G,w(a.deleteCashflowData.parkName),1)]),i("div",H,[J,i("div",K,w(a.deleteCashflowData.casedescribe),1)])])]),_:1},8,["modelValue"])])}const Z=y(E,[["render",W]]);export{Z as default};
