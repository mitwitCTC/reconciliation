import{_ as T,c as h,a as o,t as k,b as t,w as l,A as p,r as n,o as C,d as m,F as D,e as V,f as v}from"./index-uJ9wh_J2.js";const w={data(){return{pageTitle:"",carParks:[],users:[],dialogVisible:!1,currentCarPark:{name:"",companyId:"",taxNumber:"",receiptTitle:"",voucherDep:"",userId:""},isEditing:!1,companies:[],carParkFormRules:{companyId:[{required:!0,message:"請選擇公司名稱",trigger:"change"}],name:[{required:!0,message:"請輸入場站名稱",trigger:"blur"}],voucherDep:[{required:!0,message:"請輸入部門代號 (傳票部份代號)",trigger:"blur"}],userId:[{required:!0,message:"請輸入使用者代碼",trigger:"blur"}]},deleteCarParkDialogVisible:!1,deleteCarParkData:null}},computed:{dialogTitle(){return this.isEditing?"修改場站資料":"新增場站資料"}},mounted(){this.getPageTitle(),this.getCarParkData(),this.getCompanyData(),this.getUsers()},methods:{getPageTitle(){this.pageTitle=this.$route.name},getCarParkData(){const i=`${p}/main/searchCarPark`;this.axios.get(i).then(e=>{e.data.returnCode==0&&(this.carParks=e.data.data)})},getCompanyData(){const i=`${p}/main/searchCompanyInfo`;this.axios.get(i).then(e=>{e.data.returnCode==0&&(this.companies=e.data.data)})},handleCompanyChange(i){const e=this.companies.find(s=>s.id===i);this.currentCarPark.companyId=e.id,this.currentCarPark.taxNumber=e.taxNumber,this.currentCarPark.receiptTitle=e.receiptTitle},getUsers(){const i=`${p}/user/searchUser`;this.axios.get(i).then(e=>{this.users=e.data.data})},openCarParkDialog(i){if(i){this.isEditing=!0,this.currentCarPark={...i};const e=this.companies.find(s=>s.id===this.currentCarPark.companyId);this.currentCarPark.taxNumber=e.taxNumber,this.currentCarPark.receiptTitle=e.receiptTitle}else this.isEditing=!1,this.currentCarPark={name:"",taxNumber:"",receiptTitle:""};this.dialogVisible=!0},saveCarPark(){this.$refs.eidtCarParkForm.validate(i=>{if(i){if(this.isEditing){const e=`${p}/main/updateCarPark`;this.axios.post(e,this.currentCarPark).then(s=>{s.data.returnCode==0&&(alert(s.data.message),this.getCarParkData())})}else{const e=`${p}/main/insertCarPark`;this.axios.post(e,this.currentCarPark).then(s=>{s.data.returnCode==0&&(alert(s.data.message),this.getCarParkData())})}this.dialogVisible=!1}})},cancelSaveCarPark(){this.dialogVisible=!1,this.$refs.eidtCarParkForm.clearValidate()},openDeleteCarParkDialog(i){this.deleteCarParkDialogVisible=!0,this.deleteCarParkData=i},deleteCarPark(){const i=`${p}/main/deleteCarPark`;this.axios.post(i,{id:this.deleteCarParkData.id}).then(e=>{e.data.returnCode==0&&(alert(e.data.message),this.getCarParkData(),this.deleteCarParkDialogVisible=!1)})}}},N={class:"container"},U={class:"d-flex justify-content-center align-items-center"},A={class:"flex-grow-1 text-center"},F={class:"dialog-footer d-flex justify-content-end"},E={class:"d-flex flex-column"},j={class:"row mb-2 justify-content-center"},q=o("div",{class:"col-3 text-end"},"場站名稱",-1),B={class:"col-4 text-start fw-bold"},S={class:"row mb-2 justify-content-center"},R=o("div",{class:"col-3 text-end"},"統編",-1),L={class:"col-4 text-start fw-bold"},z={class:"row mb-2 justify-content-center"},G=o("div",{class:"col-3 text-end"},"抬頭",-1),H={class:"col-4 text-start fw-bold"},J={class:"dialog-footer"};function K(i,e,s,M,r,d){const c=n("el-button"),u=n("el-table-column"),x=n("el-table"),f=n("el-option"),_=n("el-select"),g=n("el-form-item"),P=n("el-input"),y=n("el-form"),b=n("el-dialog");return C(),h("div",N,[o("div",U,[o("h2",A,k(r.pageTitle),1),t(c,{class:"ms-auto",onClick:e[0]||(e[0]=a=>d.openCarParkDialog())},{default:l(()=>[m("新增")]),_:1})]),t(x,{data:r.carParks,height:"600"},{default:l(()=>[t(u,{align:"center",prop:"name",label:"場站名稱"}),t(u,{align:"center",prop:"taxNumber",label:"統編"}),t(u,{align:"center",prop:"receiptTitle",label:"抬頭"}),t(u,{align:"center",prop:"voucherDep",label:"部門代號"}),t(u,{align:"center",prop:"userId",label:"使用者代號"}),t(u,{align:"center",label:"修改",fixed:"right"},{default:l(a=>[t(c,{onClick:I=>d.openCarParkDialog(a.row)},{default:l(()=>[m("修改")]),_:2},1032,["onClick"])]),_:1}),t(u,{align:"center",label:"刪除",fixed:"right"},{default:l(a=>[t(c,{type:"danger",onClick:I=>d.openDeleteCarParkDialog(a.row)},{default:l(()=>[m("刪除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),t(b,{modelValue:r.dialogVisible,"onUpdate:modelValue":e[5]||(e[5]=a=>r.dialogVisible=a),title:d.dialogTitle,width:"500",center:""},{default:l(()=>[t(y,{model:r.currentCarPark,"label-width":"auto",rules:r.carParkFormRules,ref:"eidtCarParkForm"},{default:l(()=>[t(g,{label:"公司名稱",prop:"companyId"},{default:l(()=>[t(_,{modelValue:r.currentCarPark.companyId,"onUpdate:modelValue":e[1]||(e[1]=a=>r.currentCarPark.companyId=a),placeholder:"請選擇公司名稱",onChange:d.handleCompanyChange},{default:l(()=>[(C(!0),h(D,null,V(r.companies,a=>(C(),v(f,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),_:1}),t(g,{label:"場站名稱",prop:"name"},{default:l(()=>[t(P,{modelValue:r.currentCarPark.name,"onUpdate:modelValue":e[2]||(e[2]=a=>r.currentCarPark.name=a)},null,8,["modelValue"])]),_:1}),t(g,{label:"部門代號",prop:"voucherDep"},{default:l(()=>[t(P,{modelValue:r.currentCarPark.voucherDep,"onUpdate:modelValue":e[3]||(e[3]=a=>r.currentCarPark.voucherDep=a)},null,8,["modelValue"])]),_:1}),t(g,{label:"使用者",prop:"userId"},{default:l(()=>[t(_,{modelValue:r.currentCarPark.userId,"onUpdate:modelValue":e[4]||(e[4]=a=>r.currentCarPark.userId=a),placeholder:"請選擇使用者"},{default:l(()=>[(C(!0),h(D,null,V(r.users,a=>(C(),v(f,{key:a.id,label:a.userName,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),o("div",F,[t(c,{onClick:d.cancelSaveCarPark},{default:l(()=>[m("取消")]),_:1},8,["onClick"]),t(c,{type:"primary",onClick:d.saveCarPark},{default:l(()=>[m("確定")]),_:1},8,["onClick"])])]),_:1},8,["modelValue","title"]),t(b,{modelValue:r.deleteCarParkDialogVisible,"onUpdate:modelValue":e[7]||(e[7]=a=>r.deleteCarParkDialogVisible=a),"close-on-click-modal":!1,title:"刪除場站基本資料",width:"500",center:""},{footer:l(()=>[o("div",J,[t(c,{onClick:e[6]||(e[6]=a=>r.deleteCarParkDialogVisible=!1)},{default:l(()=>[m("取消")]),_:1}),t(c,{type:"danger",onClick:d.deleteCarPark},{default:l(()=>[m("確認刪除")]),_:1},8,["onClick"])])]),default:l(()=>[o("div",E,[o("div",j,[q,o("div",B,k(r.deleteCarParkData.name),1)]),o("div",S,[R,o("div",L,k(r.deleteCarParkData.taxNumber),1)]),o("div",z,[G,o("div",H,k(r.deleteCarParkData.receiptTitle),1)])])]),_:1},8,["modelValue"])])}const Q=T(w,[["render",K]]);export{Q as default};
